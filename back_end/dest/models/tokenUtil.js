"use strict";var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=require("babel-runtime/helpers/asyncToGenerator"),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var jwt=require("jsonwebtoken"),secret="@#$",tokenUtil={createToken:function(e,r){return console.log(e,r,"000000000"),jwt.sign({uname:e,pwd:r},secret,{expiresIn:"30d"})},checkToken:function(){var t=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(t,r){var n,a;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,null==t.request.headers.webtoken){e.next=6;break}a=t.request.headers.webtoken,jwt.verify(a,secret,function(e,r){if(console.log(e),e)return n=!0,t.status=401,void(t.message=e.message)}),e.next=10;break;case 6:return n=!0,t.status=401,t.message=err.message,e.abrupt("return");case 10:if(e.t0=!n,!e.t0){e.next=14;break}return e.next=14,r();case 14:case"end":return e.stop()}},e,this)}));return function(e,r){return t.apply(this,arguments)}}()};module.exports=tokenUtil;